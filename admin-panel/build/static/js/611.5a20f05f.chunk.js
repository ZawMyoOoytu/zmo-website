"use strict";(self.webpackChunkzmo_admin_panel=self.webpackChunkzmo_admin_panel||[]).push([[611],{611:(e,s,t)=>{t.r(s),t.d(s,{default:()=>c});var a=t(43),n=t(475),l=t(305),i=t(594),o=t(579);const r=()=>{const[e,s]=(0,a.useState)(""),[t,n]=(0,a.useState)(null),[i,r]=(0,a.useState)(!1),c=async()=>{try{r(!0),s("Testing blogs API..."),console.log("\ud83d\udd27 DEBUG: Starting API test..."),console.log("\ud83d\udd27 DEBUG: Token:",(0,l.gf)()?"Present":"Missing"),console.log("\ud83d\udd27 DEBUG: API URL:",{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_URL||"https://zmo-backend.onrender.com/api"),s("Testing direct fetch...");const e=await fetch("https://zmo-backend.onrender.com/api/blogs"),t=await e.json();console.log("\ud83d\udd27 DEBUG: Direct fetch result:",t),s("Testing blogAPI...");const a=await l.hh.getAll();console.log("\ud83d\udd27 DEBUG: blogAPI result:",a),n({directFetch:t,blogAPI:a,timestamp:(new Date).toISOString()}),s("\u2705 API test completed! Check console for details.")}catch(e){console.error("\ud83d\udd27 DEBUG: API test failed:",e),s("\u274c API test failed: ".concat(e.message)),n({error:e.message,timestamp:(new Date).toISOString()})}finally{r(!1)}};return(0,a.useEffect)(()=>{c()},[]),(0,o.jsxs)("div",{style:{background:"#f8f9fa",border:"2px solid #dee2e6",borderRadius:"8px",padding:"20px",margin:"20px 0",fontSize:"14px"},children:[(0,o.jsx)("h4",{style:{marginBottom:"15px",color:"#495057"},children:"\ud83d\udd27 API Debugger"}),(0,o.jsxs)("div",{style:{display:"flex",gap:"10px",marginBottom:"15px",flexWrap:"wrap"},children:[(0,o.jsx)("button",{onClick:c,disabled:i,className:"btn btn-primary btn-sm",children:i?"Testing...":"Test Blogs API"}),(0,o.jsx)("button",{onClick:async()=>{try{s("Creating test blog...");const t={title:"Test Blog ".concat((new Date).toLocaleTimeString()),excerpt:"This is a test blog created from debugger",content:"This is test content for debugging purposes.",author:"Debug Admin",published:!0,tags:["test","debug"],readTime:2},a=await l.hh.create(t);var e;if(console.log("\ud83d\udd27 DEBUG: Create result:",a),a.success)s("\u2705 Blog created! ID: ".concat(null===(e=a.data)||void 0===e?void 0:e._id)),setTimeout(()=>c(),2e3);else s("\u274c Create failed: ".concat(a.message))}catch(t){s("\ud83d\udca5 Create error: ".concat(t.message))}},className:"btn btn-success btn-sm",children:"Create Test Blog"}),(0,o.jsx)("button",{onClick:()=>window.location.reload(),className:"btn btn-outline-secondary btn-sm",children:"Refresh Page"})]}),(0,o.jsxs)("div",{style:{padding:"10px",background:"#fff",border:"1px solid #dee2e6",borderRadius:"4px",marginBottom:"15px"},children:[(0,o.jsx)("strong",{children:"Status:"})," ",e]}),t&&(0,o.jsxs)("div",{children:[(0,o.jsx)("h5",{children:"API Response Details:"}),(0,o.jsx)("div",{style:{background:"#fff",border:"1px solid #dee2e6",borderRadius:"4px",padding:"15px",maxHeight:"400px",overflowY:"auto",fontSize:"12px"},children:(0,o.jsx)("pre",{children:JSON.stringify(t,null,2)})})]})]})},c=()=>{const[e,s]=(0,a.useState)([]),[t,c]=(0,a.useState)(!0),[d,h]=(0,a.useState)(""),[g,m]=(0,a.useState)(""),[b,u]=(0,a.useState)([]),[x,j]=(0,a.useState)(0),[p,f]=(0,a.useState)(!0),N=()=>{console.log("\ud83d\udd04 Manual refresh triggered"),j(e=>e+1)};(0,a.useEffect)(()=>{(async()=>{try{c(!0),h(""),console.log("\ud83d\udd04 Admin: Fetching ALL blogs...");const e=await l.hh.getAll();if(console.log("\ud83d\udcca Admin Blog API response:",e),!e.success)throw new Error(e.message||"Failed to load blogs");{const t=e.blogs||e.data||[];console.log("\u2705 Admin: Loaded ".concat(t.length," blogs (including drafts)")),s(t),u(t),t.forEach((e,s)=>{console.log("\ud83d\udcdd Admin Blog ".concat(s+1,":"),{id:e._id,title:e.title,published:e.published,createdAt:e.createdAt,author:e.author})})}}catch(d){var e;console.error("\u274c Admin Blog fetch error:",d),console.error("\ud83d\udd0d Error details:",{message:d.message,code:d.code,response:null===(e=d.response)||void 0===e?void 0:e.data}),h(d.message||"Failed to load blog posts"),s([]),u([])}finally{c(!1)}})()},[x]),(0,a.useEffect)(()=>{if(""===g.trim())u(e);else{const s=e.filter(e=>{var s,t,a,n,l;return(null===(s=e.title)||void 0===s?void 0:s.toLowerCase().includes(g.toLowerCase()))||(null===(t=e.excerpt)||void 0===t?void 0:t.toLowerCase().includes(g.toLowerCase()))||(null===(a=e.content)||void 0===a?void 0:a.toLowerCase().includes(g.toLowerCase()))||(null===(n=e.tags)||void 0===n?void 0:n.some(e=>e.toLowerCase().includes(g.toLowerCase())))||(null===(l=e.author)||void 0===l?void 0:l.toLowerCase().includes(g.toLowerCase()))});u(s)}},[g,e]);const v=e=>{if(!e)return"Unknown date";try{const s={year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"};return new Date(e).toLocaleDateString("en-US",s)}catch(d){return"Invalid date"}};return t?(0,o.jsx)("div",{className:"admin-blog-list",children:(0,o.jsxs)("div",{className:"container-fluid",children:[(0,o.jsxs)("div",{className:"admin-page-header",children:[(0,o.jsx)("h1",{children:"Blog Management"}),(0,o.jsx)("p",{children:"Manage your blog posts"})]}),(0,o.jsx)(i.A,{message:"Loading blogs..."})]})}):(0,o.jsx)("div",{className:"admin-blog-list",children:(0,o.jsxs)("div",{className:"container-fluid",children:[(0,o.jsx)("div",{className:"admin-page-header",children:(0,o.jsxs)("div",{className:"header-content",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("h1",{children:"Blog Management"}),(0,o.jsx)("p",{children:"Create, edit, and manage your blog posts"})]}),(0,o.jsxs)("div",{className:"header-actions",children:[(0,o.jsxs)("button",{onClick:()=>f(!p),className:"btn btn-outline-warning btn-sm",children:[p?"Hide":"Show"," Debug"]}),(0,o.jsxs)("button",{onClick:N,className:"btn btn-outline-secondary btn-sm",title:"Refresh blog list",children:[(0,o.jsx)("i",{className:"fas fa-sync-alt"})," Refresh"]}),(0,o.jsxs)(n.N_,{to:"/blogs/create",className:"btn btn-primary",children:[(0,o.jsx)("i",{className:"fas fa-plus"})," Create New Blog"]})]})]})}),p&&(0,o.jsx)(r,{}),(0,o.jsx)("div",{className:"debug-info",children:(0,o.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("strong",{children:"\ud83d\udcca Blog Statistics:"}),(0,o.jsxs)("span",{className:"ms-3",children:["Total: ",e.length]}),(0,o.jsxs)("span",{className:"ms-2 text-success",children:["Published: ",e.filter(e=>e.published).length]}),(0,o.jsxs)("span",{className:"ms-2 text-warning",children:["Drafts: ",e.filter(e=>!e.published).length]})]}),(0,o.jsxs)("div",{children:[(0,o.jsxs)("span",{className:"text-muted me-3",children:["Last updated: ",(new Date).toLocaleTimeString()]}),(0,o.jsxs)("button",{onClick:()=>console.log("\ud83d\udd0d All blogs:",e),className:"btn btn-sm btn-outline-info",children:[(0,o.jsx)("i",{className:"fas fa-bug"})," Console Log"]})]})]})}),d&&(0,o.jsx)("div",{className:"alert alert-danger",role:"alert",children:(0,o.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("strong",{children:"Error Loading Blogs:"})," ",d]}),(0,o.jsx)("button",{onClick:N,className:"btn btn-sm btn-outline-danger",children:"Retry"})]})}),(0,o.jsx)("div",{className:"card mb-4",children:(0,o.jsx)("div",{className:"card-body",children:(0,o.jsxs)("div",{className:"row align-items-center",children:[(0,o.jsx)("div",{className:"col-md-8",children:(0,o.jsxs)("div",{className:"search-box-admin",children:[(0,o.jsx)("i",{className:"fas fa-search"}),(0,o.jsx)("input",{type:"text",placeholder:"Search blogs by title, content, tags, or author...",value:g,onChange:e=>m(e.target.value),className:"form-control"}),g&&(0,o.jsx)("button",{onClick:()=>{m("")},className:"btn btn-sm btn-outline-secondary ms-2",children:"Clear"})]})}),(0,o.jsx)("div",{className:"col-md-4 text-end",children:(0,o.jsxs)("div",{className:"btn-group",children:[(0,o.jsxs)("button",{className:"btn btn-sm ".concat(b.length===e.length?"btn-primary":"btn-outline-primary"),onClick:()=>m(""),children:["All (",e.length,")"]}),(0,o.jsxs)("button",{className:"btn btn-sm ".concat("published"===g?"btn-success":"btn-outline-success"),onClick:()=>m("published"),children:["Published (",e.filter(e=>e.published).length,")"]}),(0,o.jsxs)("button",{className:"btn btn-sm ".concat("draft"===g?"btn-warning":"btn-outline-warning"),onClick:()=>m("draft"),children:["Drafts (",e.filter(e=>!e.published).length,")"]})]})})]})})}),b.length>0?(0,o.jsx)("div",{className:"card",children:(0,o.jsx)("div",{className:"card-body",children:(0,o.jsx)("div",{className:"table-responsive",children:(0,o.jsxs)("table",{className:"table table-hover",children:[(0,o.jsx)("thead",{children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{children:"Title"}),(0,o.jsx)("th",{children:"Author"}),(0,o.jsx)("th",{children:"Status"}),(0,o.jsx)("th",{children:"Created"}),(0,o.jsx)("th",{children:"Actions"})]})}),(0,o.jsx)("tbody",{children:b.map(e=>(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{children:(0,o.jsxs)("div",{children:[(0,o.jsx)("strong",{children:e.title||"Untitled Blog"}),e.tags&&e.tags.length>0&&(0,o.jsxs)("div",{className:"text-muted small mt-1",children:["Tags: ",e.tags.slice(0,3).join(", "),e.tags.length>3&&" +".concat(e.tags.length-3," more")]})]})}),(0,o.jsx)("td",{children:e.author||"Admin"}),(0,o.jsx)("td",{children:e.published?(0,o.jsx)("span",{className:"badge bg-success",children:"Published"}):(0,o.jsx)("span",{className:"badge bg-warning",children:"Draft"})}),(0,o.jsx)("td",{children:v(e.createdAt)}),(0,o.jsx)("td",{children:(0,o.jsxs)("div",{className:"btn-group btn-group-sm",children:[(0,o.jsx)(n.N_,{to:"/blogs/edit/".concat(e._id),className:"btn btn-primary",title:"Edit",children:(0,o.jsx)("i",{className:"fas fa-edit"})}),(0,o.jsx)(n.N_,{to:"/blogs/view/".concat(e._id),className:"btn btn-info",title:"View",children:(0,o.jsx)("i",{className:"fas fa-eye"})})]})})]},e._id))})]})})})}):(0,o.jsx)("div",{className:"card",children:(0,o.jsx)("div",{className:"card-body text-center py-5",children:(0,o.jsxs)("div",{className:"text-muted",children:[(0,o.jsx)("i",{className:"fas fa-newspaper fa-3x mb-3"}),(0,o.jsx)("h4",{children:"No blogs found"}),(0,o.jsx)("p",{children:g?"No blogs match your search criteria.":"No blogs have been created yet."}),(0,o.jsxs)("p",{className:"text-danger small mt-3",children:[(0,o.jsx)("strong",{children:"Debug Info:"})," Check the API Debugger above to see what's happening with the API calls."]}),(0,o.jsxs)(n.N_,{to:"/blogs/create",className:"btn btn-primary mt-2",children:[(0,o.jsx)("i",{className:"fas fa-plus"})," Create Your First Blog"]})]})})})]})})}}}]);
//# sourceMappingURL=611.5a20f05f.chunk.js.map