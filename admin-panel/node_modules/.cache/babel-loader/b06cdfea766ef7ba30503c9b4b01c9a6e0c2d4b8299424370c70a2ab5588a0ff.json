{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\heart\\\\zmowebsite\\\\admin-panel\\\\src\\\\contexts\\\\AuthContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useState, useContext, useEffect } from 'react';\nimport { authAPI, testBackendConnection } from '../services/api';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AuthContext = /*#__PURE__*/createContext();\nexport function useAuth() {\n  _s();\n  const context = useContext(AuthContext);\n  if (!context) {\n    throw new Error('useAuth must be used within an AuthProvider');\n  }\n  return context;\n}\n_s(useAuth, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\nexport function AuthProvider({\n  children\n}) {\n  _s2();\n  const [user, setUser] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [backendStatus, setBackendStatus] = useState('checking');\n  const [authLoading, setAuthLoading] = useState(false);\n\n  // Check backend connection and existing auth on app start\n  useEffect(() => {\n    initializeAuth();\n  }, []);\n  const initializeAuth = async () => {\n    try {\n      // Test backend connection first\n      const connectionResult = await testBackendConnection();\n      setBackendStatus(connectionResult.success ? 'connected' : 'disconnected');\n\n      // Check for existing authentication\n      const currentUser = authAPI.getCurrentUser();\n      const isAuthenticated = authAPI.isAuthenticated();\n      if (isAuthenticated && currentUser) {\n        try {\n          // Verify token is still valid\n          await authAPI.verify();\n          setUser(currentUser);\n          console.log('âœ… User session restored:', currentUser.email);\n        } catch (error) {\n          console.log('âŒ Token verification failed, logging out');\n          await logout();\n        }\n      }\n    } catch (error) {\n      console.error('Auth initialization error:', error);\n      setBackendStatus('disconnected');\n    } finally {\n      setLoading(false);\n    }\n  };\n  const login = async (email, password, rememberMe = false) => {\n    setAuthLoading(true);\n    try {\n      console.log('ðŸ” Attempting login...', {\n        email,\n        rememberMe\n      });\n\n      // Test connection first\n      const connection = await testBackendConnection();\n      if (!connection.success) {\n        throw new Error('Cannot connect to backend server. Please check if the server is running.');\n      }\n      const result = await authAPI.login(email, password, rememberMe);\n      if (result.success) {\n        setUser(result.user);\n        setBackendStatus('connected');\n        console.log('âœ… Login successful:', result.user.email);\n        return result;\n      } else {\n        throw new Error(result.message || 'Login failed');\n      }\n    } catch (error) {\n      console.error('âŒ Login error:', error);\n      setBackendStatus('disconnected');\n\n      // Enhanced error messages\n      let errorMessage = error.message;\n      if (error.message.includes('Network Error') || error.message.includes('Cannot connect')) {\n        errorMessage = 'Cannot connect to the server. Please check your internet connection and ensure the backend is running.';\n      } else if (error.message.includes('timeout')) {\n        errorMessage = 'Server is taking too long to respond. Please try again.';\n      }\n      throw new Error(errorMessage);\n    } finally {\n      setAuthLoading(false);\n    }\n  };\n  const logout = async () => {\n    try {\n      await authAPI.logout();\n    } catch (error) {\n      console.log('Logout cleanup:', error.message);\n    } finally {\n      setUser(null);\n      setBackendStatus('checking');\n      console.log('ðŸ‘‹ User logged out');\n    }\n  };\n  const checkConnection = async () => {\n    try {\n      const result = await testBackendConnection();\n      setBackendStatus(result.success ? 'connected' : 'disconnected');\n      return result;\n    } catch (error) {\n      setBackendStatus('disconnected');\n      return {\n        success: false,\n        error: error.message\n      };\n    }\n  };\n  const value = {\n    // State\n    user,\n    loading,\n    authLoading,\n    backendStatus,\n    // Actions\n    login,\n    logout,\n    checkConnection,\n    // Computed\n    isAuthenticated: !!user\n  };\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: value,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 133,\n    columnNumber: 5\n  }, this);\n}\n_s2(AuthProvider, \"D95HhLzPlK/egJw2TPjeeDDAYp4=\");\n_c = AuthProvider;\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["React","createContext","useState","useContext","useEffect","authAPI","testBackendConnection","jsxDEV","_jsxDEV","AuthContext","useAuth","_s","context","Error","AuthProvider","children","_s2","user","setUser","loading","setLoading","backendStatus","setBackendStatus","authLoading","setAuthLoading","initializeAuth","connectionResult","success","currentUser","getCurrentUser","isAuthenticated","verify","console","log","email","error","logout","login","password","rememberMe","connection","result","message","errorMessage","includes","checkConnection","value","Provider","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/heart/zmowebsite/admin-panel/src/contexts/AuthContext.js"],"sourcesContent":["import React, { createContext, useState, useContext, useEffect } from 'react';\r\nimport { authAPI, testBackendConnection } from '../services/api';\r\n\r\nconst AuthContext = createContext();\r\n\r\nexport function useAuth() {\r\n  const context = useContext(AuthContext);\r\n  if (!context) {\r\n    throw new Error('useAuth must be used within an AuthProvider');\r\n  }\r\n  return context;\r\n}\r\n\r\nexport function AuthProvider({ children }) {\r\n  const [user, setUser] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [backendStatus, setBackendStatus] = useState('checking');\r\n  const [authLoading, setAuthLoading] = useState(false);\r\n\r\n  // Check backend connection and existing auth on app start\r\n  useEffect(() => {\r\n    initializeAuth();\r\n  }, []);\r\n\r\n  const initializeAuth = async () => {\r\n    try {\r\n      // Test backend connection first\r\n      const connectionResult = await testBackendConnection();\r\n      setBackendStatus(connectionResult.success ? 'connected' : 'disconnected');\r\n\r\n      // Check for existing authentication\r\n      const currentUser = authAPI.getCurrentUser();\r\n      const isAuthenticated = authAPI.isAuthenticated();\r\n\r\n      if (isAuthenticated && currentUser) {\r\n        try {\r\n          // Verify token is still valid\r\n          await authAPI.verify();\r\n          setUser(currentUser);\r\n          console.log('âœ… User session restored:', currentUser.email);\r\n        } catch (error) {\r\n          console.log('âŒ Token verification failed, logging out');\r\n          await logout();\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error('Auth initialization error:', error);\r\n      setBackendStatus('disconnected');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const login = async (email, password, rememberMe = false) => {\r\n    setAuthLoading(true);\r\n    try {\r\n      console.log('ðŸ” Attempting login...', { email, rememberMe });\r\n\r\n      // Test connection first\r\n      const connection = await testBackendConnection();\r\n      if (!connection.success) {\r\n        throw new Error('Cannot connect to backend server. Please check if the server is running.');\r\n      }\r\n\r\n      const result = await authAPI.login(email, password, rememberMe);\r\n      \r\n      if (result.success) {\r\n        setUser(result.user);\r\n        setBackendStatus('connected');\r\n        console.log('âœ… Login successful:', result.user.email);\r\n        return result;\r\n      } else {\r\n        throw new Error(result.message || 'Login failed');\r\n      }\r\n    } catch (error) {\r\n      console.error('âŒ Login error:', error);\r\n      setBackendStatus('disconnected');\r\n      \r\n      // Enhanced error messages\r\n      let errorMessage = error.message;\r\n      if (error.message.includes('Network Error') || error.message.includes('Cannot connect')) {\r\n        errorMessage = 'Cannot connect to the server. Please check your internet connection and ensure the backend is running.';\r\n      } else if (error.message.includes('timeout')) {\r\n        errorMessage = 'Server is taking too long to respond. Please try again.';\r\n      }\r\n      \r\n      throw new Error(errorMessage);\r\n    } finally {\r\n      setAuthLoading(false);\r\n    }\r\n  };\r\n\r\n  const logout = async () => {\r\n    try {\r\n      await authAPI.logout();\r\n    } catch (error) {\r\n      console.log('Logout cleanup:', error.message);\r\n    } finally {\r\n      setUser(null);\r\n      setBackendStatus('checking');\r\n      console.log('ðŸ‘‹ User logged out');\r\n    }\r\n  };\r\n\r\n  const checkConnection = async () => {\r\n    try {\r\n      const result = await testBackendConnection();\r\n      setBackendStatus(result.success ? 'connected' : 'disconnected');\r\n      return result;\r\n    } catch (error) {\r\n      setBackendStatus('disconnected');\r\n      return { success: false, error: error.message };\r\n    }\r\n  };\r\n\r\n  const value = {\r\n    // State\r\n    user,\r\n    loading,\r\n    authLoading,\r\n    backendStatus,\r\n    \r\n    // Actions\r\n    login,\r\n    logout,\r\n    checkConnection,\r\n    \r\n    // Computed\r\n    isAuthenticated: !!user,\r\n  };\r\n\r\n  return (\r\n    <AuthContext.Provider value={value}>\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}